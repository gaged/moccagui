#summary mocca kompilieren und installieren

== Übersicht ==

Voraussetzungen:
  * Installiertes EMC2 2.3.4, einschließlich -dev
  * Installiertes lazarus, siehe wiki seite "lazarus"

Derzeit wird kein binary package veröffentlicht, da die Änderungsrate noch zu groß ist.

Kompilieren und Installieren erfordert folgende Schritte
  # Source code herunterladen bzw. aktualisieren
  # Kompilieren mit makefile
  # Installieren

== Source code ==
=== herunterladen ===
  # `svn checkout http://moccagui.googlecode.com/svn/trunk/ mocca`
  # `cd mocca`
=== aktualiseren ===
Wenn das Verzeichnis mocca durch svn checkout bereits angelegt wurde, kann es mit svn update immer wieder auf den neuesten Stand aktualisiert werden. Mit -r XX auch auf eine beliebige Version XX.
  # `cd mocca`
  # `svn update [-r XX]`

== Kompilieren mit makefile ==
  # Ins src Verzeichnis wechseln: `cd src`
  # Makefile anpassen, siehe [mocca#makefile]
  # Alles kompilieren und linken: `make all`

== Installieren ==
 # Nach ../lib wechseln: `cd ../lib`
 # Mocca ausführbar machen: `chmod a+x mocca`
 # Einen symbolischen Link in /usr/bin einfügen: `sudo ln -s mocca /usr/bin/mocca`
Das letztere muss nur einmalig gemacht werden

== makefile ==

Das Makefile muss den lokalen Gegebenheiten angepasst werden.

Dies betrifft insbesondere die Pfade zu EMCDIR und ggf. zu lazarus.

Zusätzlich kann es erforderlich sein, die Include Verzeichnisse zu erweitern, ein guter Ansatz ist folgende Konfiguration (Pfade ggf. anpassen):

{{{
INCLUDES = -I$(EMCDIR)/include
INCLUDES += -I$(EMCDIR)/src
INCLUDES += -I$(EMCDIR)/lib
INCLUDES += -I$(EMCDIR)/bin
INCLUDES += -I$(EMCDIR)/src/emc/ini
INCLUDES += -I/usr/lib
INCLUDES += -I/lib

INCLUDES += -I$(EMCDIR)/src/emc/iotask
INCLUDES += -I$(EMCDIR)/src/emc/kinematics
INCLUDES += -I$(EMCDIR)/src/emc/motion
INCLUDES += -I$(EMCDIR)/src/emc/nml_intf
INCLUDES += -I$(EMCDIR)/src/emc/usr_intf
INCLUDES += -I$(EMCDIR)/src/emc/rs274ngc
INCLUDES += -I$(EMCDIR)/src/emc/task
INCLUDES += -I$(EMCDIR)/src/libnml/posemath
INCLUDES += -I$(EMCDIR)/src/libnml/inifile
INCLUDES += -I$(EMCDIR)/src/libnml/os_intf
INCLUDES += -I$(EMCDIR)/src/libnml/nml
INCLUDES += -I$(EMCDIR)/src/libnml/cms
INCLUDES += -I$(EMCDIR)/src/libnml/rcs
}}}

Sollte es beim Start von Mocca zu einem X-Server Fehler kommen, so ist im Makefile die Zeile 

WM=gtk2

durch

WM=gtk

zu ersetzen und neu zu kompilieren. Ggf. müssen noch einige Libraries nachinstalliert werden, siehe Wiki Lazarus installieren.

Die Datei mocca.inc enthält einige $define direktiven. Eine davon ($DEFINE OWNGL) wird dazu verwendet das Lazarus OpenGlControl durch ein internes TGlControl zu ersetzen. Wer also Lazarus NICHT mit dem Package LazOPenGlContext.0.0.1 verwendet MUSS hier $DEFINE OWNGL definieren. 